// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Type {
  AUDIO
  VIDEO
}

model User {
  id        Int       @id @unique @default(autoincrement())
  username  String
  mail      String
  password  String
  profilPic String
  Friend1   Friend[]  @relation("User1")
  Friend2   Friend[]  @relation("User2")
  Message   Message[] @relation("fromUserId")
  Call      Call[]    @relation("userId")
}

model Friend {
  id       Int       @id @unique @default(autoincrement())
  user1Id  Int
  user2Id  Int
  user1    User      @relation("User1", fields: [user1Id], references: [id])
  user2    User      @relation("User2", fields: [user2Id], references: [id])
  Message  Message[] @relation("friendId")
  FriendId Call[]    @relation("friendId")
}

model Message {
  id         Int      @id @unique @default(autoincrement())
  sent       DateTime
  message    String
  fromUserId Int
  friendId   Int
  fromUser   User     @relation("fromUserId", fields: [fromUserId], references: [id])
  friend     Friend   @relation("friendId", fields: [friendId], references: [id])
  read       Boolean
}

model Call {
  id        Int      @id @unique @default(autoincrement())
  friendId  Int
  whoCallId Int
  friend    Friend   @relation("friendId", fields: [friendId], references: [id])
  start     DateTime
  end       DateTime
  whoCall   User     @relation("userId", fields: [whoCallId], references: [id])
  type      Type
  respond   Boolean
}
